TITLE(1)="OIL-WATER THERMAL TEST"
TITLE(2)="Scenario 3"

DESCRIPTION()=
"GRID BLOCKS : 1x100x1 (down, lateral, lateral) =  100 GRID ELEMENTS"

BLOCKMODEL(1)="COMPOSITIONAL_MODEL"

$TIMEEND = 10000.1
TIMEEND = 1000.1
$TIMEEND = 100.1
$TIMEEND = 10.1
$TIMEEND = 1.0
$TIMEEND = 0.1
$TIMEEND = 0.01

$ I/O OPTIONS
 DEBUGS  
 DEBUGM
 OUTLEVEL = 3
 BUGKEY(6)
 BUGKEY(10)

$ LINEAR SOLVER OPTIONS

$ BCGS OPTIONS
LINTOL = 1.0E-04

$GMRES OPTIONS
$SAMG
$LSOL_TOL = 1.0E-05
$LSOL_ITMAX = 500
$GMRES_PREC = 17
$GMRES_PREC = 13
$N_GS_STEP = 5

$ WELL OUTPUT

WELLOUTKEY = 3  WELLFILE = "OLWT_TH0.WEL"  WELLFCUM = "OLWT_TH0.CUM"

$ FAULT BLOCK AND MESH DATA

DOWN() = 1 0 0
NX(1) = 1   NY(1) = 100     NZ(1) = 1
DX(,1) = 10.0  DY(,1) = 25.0  DZ(,1) = 1.0

$ WATER PROPERTIES
WATERP = 14.7
WATFVF = 1.0
WATVIS = .7
WATCMP = 3.3E-6
STDENW = 62.4

$ PHASE THERMAL CONDUCTIVITIES
$PHTCOND(1 TO 4,1) = 0.0
$PHTCOND(1 TO 4,2) = 0.0
$PHTCOND(1 TO 4,3) = 0.0

PHTCOND(1 TO 4,1) = 48.5343  8.1714  10.8856  0.2203
PHTCOND(1 TO 4,2) = 48.5343  8.1714  10.8856  0.2203
PHTCOND(1 TO 4,3) = 48.5343  8.1714  10.8856  0.2203

$ COMP NAMES
NHCOMP = 1
COMP(1) = "C10" 
XNO_DIFFDISP
XTHERMAL = TRUE
$XNOTHERMCOND = TRUE
XTHERMSOLVE = TRUE
XTHLINSOL = 2
XFLXLMTRTYPE = 3
XFLXLMTR = 1.0

$DEL_TR = 5.0

$$ COMPNT. CRIT. PROPERTIES

$ CRITICAL TEMPERATURES
$TCRIT(1) = 547.43004

$ CRITICAL PRESSURES
$PCRIT(1) = 1069.9972

$ CRITICAL VOLUMES
$ZCRIT(1) = 0.27492
$ZCRIT(1) = 0.29992

$ ACENTRIC FACTORS
$ACENT(1) = 0.22394

$ MOL WEIGHTS
$MOLWT(1) = 44.0100

$ PARACHOR
$PARACHOR(1) = 78.00

$ VOLUMETRIC SHIFT
$VSHIFT(1) = 0.114668
$VSHIFT(1) = -1.733828
$VSHIFT(1) = -1.786728

$ COMPOSITIONAL TOLERANCES
$TOL_FLASH = 1.0E-10
TOL_SAT = 1.0E-05
$TOL_PW = 1.0E-07
$TOL_RATE = 1.0E-09
$OVERSHOOT = 1.0E-10

$ BINARY INTERACTION COEFFICIENTS

MODREL(1)  2

$ SURFACE CONDITIONS 
TSURF = 60.0  PSURF = 14.7

$ Set the top corner of the reservoir
XYZ111(,1) = 0.0 0.0 0.0

$ INITIAL CONDITIONS

PORPRES1() = 14.7
$SWINIT1() = 0.6
SWINIT1() = 0.0
PRES1() = 5000.0
$CONC1(,,,1) = 0.0
CONC1(,,,1) = 1.0

$ INITIAL TEMPERATURES
TEMPR1() = 60.0

$ SEPARATORS
PSEP(,1) = 14.7
TSEP(,1) = 60.

$ SEPARATOR ASSIGNMENT FOR IN-PLACE CALCULATIONS
SEPSURF = 1

$ POROSITY
CR1() = 0.0
POROSITY1() = 0.38

$ PERMEABILITIES

$XPERM1() = 400000.0   YPERM1() = 400000.0   ZPERM1() = 400000.0
$XPERM1() = 400.0   YPERM1() = 400.0   ZPERM1() = 400.0
XPERM1() = 1000.0   YPERM1() = 1000.0   ZPERM1() = 1000.0
$XPERM1() = 20.265   YPERM1() = 20.265   ZPERM1() = 20.265
$XPERM1() = 10.0   YPERM1() = 10.0   ZPERM1() = 10.0

$ REL. PERMEABILITY AND CAP. PRESSURE TABLES
Include P1_2MDrelprm.dat

Include CapPres.dat

$ WELLS

NUMWELL=2

WELLNAME(1) = "WELL 1 INJECTION"
$KINDWELL(1) = 1
KINDWELL(1) = 2
$WDEPTH(1) = 1.143
WELLTOP(1 TO 3,1,1) =     0.0  12.5  0.5
WELLBOTTOM(1 TO 3,1,1) =  10.0  12.5  0.5
WELLPQ(1) Block
  Interpolation Step
  Extrapolation Constant
  $Data    0.   5100.0 
  $Data    0.   100.0 
  Data    0.   10.0 
EndBlock

WELLNAME(2) = "WELL 2 PRODUCTION"
KINDWELL(2) = 31
$PLIMITC(2) = 1000.
WELLTOP(1 TO 3,1,2) =    0.0  2437.5  0.5
WELLBOTTOM(1 TO 3,1,2) = 10.0  2437.5  0.5
WELLPQ(2) Block
  Interpolation Step
  Extrapolation Constant
  Data   0.    4900.0
EndBlock

$ INJECTION COMPOSITION
COMPINJ(,1) = 1.0 0.0 
INJCOMP(1) = 1
$TINJ(1) = 100.0
TINJ(1) = 60.0
$TINJ(1) = 96.8

$ SEPARATOR ASSIGNMENT FOR WELLS
IWSEP(2) = 1
OUT_1DTEMPR = TRUE
$OUT_1DCP = TRUE
$OUT_1DMDEN = TRUE
$OUT_1DVEL = TRUE

EndInitial

$ TRANSIENT DATA INPUT BLOCKS

BeginTime    0.0
   $DELTIM = 0.001 
   $DELTIM = 0.0001 
   DELTIM = 0.00001 
   DTIMMUL = 1.02 
   DTIMMIN = 1.0E-05
   $DTIMMAX = 2.0
   DTIMMAX = 1.0
   $DTIMMAX = 0.05
   $DTIMOUT = 0.01
   $TIMOUT = 0.1
   $DTIMOUT = 0.1
   $TIMOUT = 0.1
   $DTIMOUT = 0.5
   TIMOUT = 0.1
   DTIMOUT = 5.0
   $DSMAX .1
   $DSMAX .01
   DSMAX .001

   $ INJECTION COMPOSITION
   $COMPINJ(,1) = 0.0 0.77 0.20 0.03 0.0 0.0 0.0
   $INJCOMP() = 1

   $ SEPARATOR ASSIGNMENT FOR WELLS
   $IWSEP() = 1

   $ VISUALIZATION
   $VISOUT = 0.1  DVISOUT = 121.66
   $VISOUT = 0.1  DVISOUT = 0.5
   $VISOUT = 0.1  DVISOUT = 0.1
   $VISOUT = 0.1  DVISOUT = 10.0
   VISOUT = 0.1  DVISOUT = 100.0
   VIS_SCL = 6
   VIS_SCL_NAMES(1) = "PRES"
   VIS_SCL_NAMES(2) = "SWAT"
   VIS_SCL_NAMES(3) = "SOIL"
   VIS_SCL_NAMES(4) = "SGAS"
   VIS_SCL_NAMES(5) = "C10"
   VIS_SCL_NAMES(6) = "TEMP"
   VIS_FNAME = "OIL_WATr0_"
   VISFLAG = 3
EndTime

$BeginTime  10.0
$KINDWELL(1) = 0
$EndTime

$BeginTime  110.0
$DELTIM = 0.0005
$EndTime
