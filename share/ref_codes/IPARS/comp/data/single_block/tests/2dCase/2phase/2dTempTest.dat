TITLE(1)="HOT WATER INJECTION TEST"
TITLE(2)="Scenario 1"

DESCRIPTION()=
"GRID BLOCKS : 1x50x1 (down, lateral, lateral) =  50 GRID ELEMENTS"

BLOCKMODEL(1)="COMPOSITIONAL_MODEL"

$TIMEEND = 1000.1
TIMEEND = 100.1
$TIMEEND = 10.1
$TIMEEND = 1.1
$TIMEEND = 0.1
$TIMEEND = 0.01

$ I/O OPTIONS
 DEBUGS  
 DEBUGM
 OUTLEVEL = 3
 BUGKEY(6)
 BUGKEY(10)

$ NEWTON OPTIONS
MAXNEWT = 50
MAXFLITS = 60

$ LINEAR SOLVER 

$ BCGS OPTIONS
LINTOL = 1.0E-04
MISCLINTOL = 1.0E-08

$ GMRES OPTIONS
$SAMG
$LSOL_TOL = 1.0E-05
$LSOL_ITMAX = 500
$GMRES_PREC = 17
$GMRES_PREC = 13
$N_GS_STEP = 5

$ WELL OUTPUT

WELLOUTKEY = 3  WELLFILE = "OW_R1.WEL"  WELLFCUM = "OW_R1.CUM"

$ FAULT BLOCK AND MESH DATA

DOWN() = 1 0 0
$NX(1) = 8   NY(1) = 26     NZ(1) = 1
$DX(,1) = 4*3.25 2*3.5 2*3.0  
$DY(,1) = 8*54.0  8*38.40  8*56.50  2*63.50
$DZ(,1) = 82.02

NX(1) = 16   NY(1) = 100     NZ(1) = 1
$DX(,1) = 4*3.25 2*3.5 2*3.0  
DX(,1) = 1.625
DY(,1) = 13.182
DZ(,1) = 82.02

$NX(1) = 8   NY(1) = 200     NZ(1) = 1
$$DX(,1) = 4*3.25 2*3.5 2*3.0  
$DX(,1) = 1.625 
$DY(,1) = 6.591
$DZ(,1) = 82.02

$ WATER PROPERTIES
WATERP = 14.7
WATFVF = 1.0
WATVIS = .7
WATCMP = 3.3E-6
STDENW = 62.4

$ PHASES
$PHTCOND(1 TO 4,1) = 0.0
$$PHTCOND(1 TO 4,2) = 0.0
$PHTCOND(1 TO 4,2) = 8000.0
$PHTCOND(1 TO 4,3) = 0.0

PHTCOND(1 TO 4,1) = 48.5343  8.1714  10.8856  0.2203
PHTCOND(1 TO 4,2) = 48.5343  8.1714  10.8856  0.2203
PHTCOND(1 TO 4,3) = 48.5343  8.1714  10.8856  0.2203

$ DIFFUSION/DISPERSION AND THERMAL FLAGS
XNO_DIFFDISP
XTHERMAL = TRUE
$XTHCFLCHECK = FALSE
$XNOFLXLMTR = TRUE
XFLXLMTRTYPE = 3
XFLXLMTR = 1.0
$XFLXLMTR = 0.85
XTHERMSOLVE = TRUE
XTHSOLTHETA = 0.45
XTHLINSOL = 2

$ COMP NAMES
NHCOMP = 1
COMP(1) = "C10"

$ COMPOSITIONAL TOLERANCES
TOL_SAT = 1.0E-05

MODREL(1)  2

$ SURFACE CONDITIONS 
TSURF = 60.0  PSURF = 14.7

$ Set the top corner of the reservoir
XYZ111(,1) = 0. 0. 0.

$ INITIAL CONDITIONS

PORPRES1() = 0.0
$SWINIT1() = 1.0
PRES1() = 3771.04
CONC1(,,,1) = 1.0

$ INITIAL TEMPERATURES
TEMPR1() = 86.0
DEL_TR = 0.01

$ SEPARATORS
PSEP(,1) = 14.7
TSEP(,1) = 60.

$ SEPARATOR ASSIGNMENT FOR IN-PLACE CALCULATIONS
SEPSURF = 1

$ ROCK DENSITY, COMPRESSIBILTY AND POROSITY
XRHOS1() = 115.5
CR1() = 0.0

$Include poro2d.dat
Include CWInj_16x100poro

$ PERMEABILITIES

$Include perm2d.dat
Include CWInj_16x100permX
Include CWInj_16x100permY
Include CWInj_16x100permZ

$ REL. PERMEABILITY AND CAP. PRESSURE TABLES
Include P1_2MDrelprm.dat
Include CapPres.dat

$ WELLS

NUMWELL=2

WELLNAME(1) = "WELL 1 INJECTION"
KINDWELL(1) = 1
$KINDWELL(1) = 2
PLIMITC(1) = 50000.
$WDEPTH(1) = 1.143
$WELLTOP(1 TO 3,1,1) =      0.0  5.0  41.01
$WELLBOTTOM(1 TO 3,1,1) =  26.0  5.0  41.01
WELLTOP(1 TO 3,1,1) =      0.0  3.0  41.01
WELLBOTTOM(1 TO 3,1,1) =  26.0  3.0  41.01
WELLPQ(1) Block
  Interpolation Step
  Extrapolation Constant
  Data    0.   4121.04 
EndBlock

WELLNAME(2) = "WELL 2 PRODUCTION"
KINDWELL(2) = 31
$PLIMITC(2) = 50000.
$WDEPTH(2) = 1.143
$WELLTOP(1 TO 3,1,2) =     0.0  1313.2  41.01
$WELLBOTTOM(1 TO 3,1,2) = 26.0  1313.2 41.01
WELLTOP(1 TO 3,1,2) =     0.0  1315.2  41.01
WELLBOTTOM(1 TO 3,1,2) = 26.0  1315.2 41.01
WELLPQ(2) Block
  Interpolation Step
  Extrapolation Constant
  Data   0.    3771.04
EndBlock

$ INJECTION COMPOSITION
$COMPINJ(,1) = 0.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 
$INJCOMP(1) = 1
$INJCOMP(2) = 1
TINJ(1) = 60.0

$ SEPARATOR ASSIGNMENT FOR WELLS
$IWSEP(2) = 1

EndInitial

$ TRANSIENT DATA INPUT BLOCKS

BeginTime    0.0
   $DELTIM = 0.005  
   $DTIMMUL = 1.01 
   DELTIM = 0.05
   DTIMMUL = 1.01 
   $DELTIM = 1.0
   $DTIMMUL = 1.01 
   DTIMMIN = .001
   DTIMMAX = 10.0
   $DTIMMIN = 1.0E-04
   $DTIMMAX = 2.0
   DTIMOUT = 121.66
   $TIMOUT = 0.005
   $DTIMOUT = 0.001
   $TIMOUT = 0.01
   $DTIMOUT = 0.01
   $TIMOUT = 0.05
   $DTIMOUT = 0.01
   $TIMOUT = 1.0
   $DTIMOUT = 1.0
   DSMAX .1
   $DSMAX .01

   $ INJECTION COMPOSITION
   $COMPINJ(,1) = 0.0 0.77 0.20 0.03 0.0 0.0 0.0
   $INJCOMP() = 1

   $ SEPARATOR ASSIGNMENT FOR WELLS
   $IWSEP() = 1

   $ VISUALIZATION
   $VISOUT = 0.01  DVISOUT = 50.0
   VISOUT = 0.01  DVISOUT = 0.05
   $VISOUT = 0.01  DVISOUT = 5.01
   $VISOUT = 0.01  DVISOUT = 0.1
   $VISOUT = 0.01  DVISOUT = 0.5
   $VISOUT = 0.01  DVISOUT = 1.0
   VIS_SCL = 3
   VIS_SCL_NAMES(1) = "PRES"
   VIS_SCL_NAMES(2) = "SWAT"
   VIS_SCL_NAMES(3) = "TEMP"
   VIS_NVEC = 1
   VIS_VEC_NAMES(1) = "XVEL_WAT"
   VIS_FNAME = "CW_INJr0_"
   VISFLAG = 3
EndTime

BeginTime  1.0
DVISOUT = 1.0
EndTime
