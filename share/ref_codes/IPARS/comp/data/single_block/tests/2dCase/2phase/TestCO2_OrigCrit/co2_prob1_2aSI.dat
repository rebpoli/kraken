TITLE(1)="CO2 PLUME EVOLUTION AND LEAKAGE VIA ABANDONED WELL"
TITLE(2)="Problem 1.2a"

DESCRIPTION()=
"GRID BLOCKS : 27x30x1 (down, lateral, lateral) =  810 GRID ELEMENTS"

BLOCKMODEL(1)="COMPOSITIONAL_MODEL"

$TIMEEND = 1001.1
TIMEEND = 101.1
$TIMEEND = 10.1
$TIMEEND = 5.1
$TIMEEND = 1.1
$TIMEEND = 0.51
$TIMEEND = 0.251
$TIMEEND = 0.1
$TIMEEND = 0.05
$TIMEEND = 0.01
$TIMEEND = 0.001
$TIMEEND = 0.0005
$TIMEEND = 0.0001
$TIMEEND = 0.00001

$ I/O OPTIONS
$ DEBUGS  
$ DEBUGM
 OUTLEVEL = 3
$ BUGKEY(6)
$ BUGKEY(10)

$ LINEAR SOLVER OPTIONS

$SAMG
LSOL_TOL = 1.0E-05
LSOL_ITMAX = 1000
GMRES_PREC = 13
N_GS_STEP = 5

$ WELL OUTPUT

WELLOUTKEY = 3  WELLFILE = "CO2P1_2aSI.WEL"  WELLFCUM = "CO2P1_2aSI.CUM"

$ FAULT BLOCK AND MESH DATA

DOWN(,1) = 1 0 0
NX(1) = 27   NY(1) = 30     NZ(1) = 1
DX(,1) = 2.0[m] 4.0[m] 4.0[m] 10.0[m] 4.0[m] 4.0[m] 1.4[m] 0.3[m] 
         0.2[m] 0.1[m] 33.3[m] 33.3[m] 33.3[m] 0.1[m] 0.1[m] 0.2[m] 
         0.2[m] 0.5[m] 0.5[m] 0.5[m] 1.5[m] 1.5[m] 1.5[m] 4.5[m] 4.5[m] 
         4.5[m] 10.0[m]
DY(,1) = 100.0[m] 100.0[m] 50.0[m] 50.0[m] 50.0[m] 30.0[m] 15.0[m] 2.0[m] 
         2.0[m] 2.0[m] 2.0[m] 2.0[m] 15.0[m] 20.0[m] 20.0[m] 20.0[m] 
         15.0[m] 2.0[m] 2.0[m] 2.0[m] 2.0[m] 2.0[m] 15.0[m] 30.0[m] 50.0[m] 
         50.0[m] 50.0[m] 100.0[m] 100.0[m] 100.0[m]
DZ(,1) = 2.0[m] 

$ WATER PROPERTIES
WATERP = 14.7
WATFVF = 1.0
WATVIS = 0.2535
WATCMP = 3.3E-6
STDENW = 57.88
$STDENW = 65.2372

$ PHASE THERMAL CONDUCTIVITIES
PHTCOND(1 TO 4,1) = 0.0
PHTCOND(1 TO 4,2) = 0.0
PHTCOND(1 TO 4,3) = 0.0
$ ROCK ISOCHORIC SPECIFIC HEAT CAPACITY
ROCKCV = 0.17913

$ COMP NAMES
NHCOMP = 2
COMP(1) = "CO2"  COMP(2) = "BRINE"
XNO_DIFFDISP
XTHERMAL = TRUE
XNOTHERMCOND = TRUE

$$ COMPNT. CRIT. PROPERTIES 

$ CRITICAL TEMPERATURES
TCRIT(1 TO 2) = 547.5700  1164.76992 

$ CRITICAL PRESSURES
$PCRIT(1 TO 2) = 1070.6000  3200.11027
PCRIT(1 TO 2) = 1070.6000  2900.11027 $ matches oil(water) phase props.

$ CRITICAL VOLUMES
$ZCRIT(1 TO 2) = 0.27420  0.23022
$ZCRIT(1 TO 2) = 0.29992  0.20022 
$ZCRIT(1 TO 2) = 0.27420  0.18600 
ZCRIT(1 TO 2) = 0.27420  0.18500 
$ZCRIT(1 TO 2) = 0.29992  0.18600 $ matches oil(water) phase props.

$ ACENTRIC FACTORS
$ACENT(1 TO 2) = 0.23100  0.34400 
ACENT(1 TO 2) = 0.23100  0.34400
$ACENT(1 TO 2) = 0.22394  0.34400

$ MOL WEIGHTS
$MOLWT(1 TO 2) = 44.0100  18.0150 
MOLWT(1 TO 2) = 44.0100  19.3537

$ PARACHOR
PARACHOR(1 TO 2) = 49.00  52.00
$PARACHOR(1 TO 2) = 78.00  52.00

$ VOLUMETRIC SHIFT
$VSHIFT(1 TO 2) = -0.08170  0.305780
$VSHIFT(1 TO 2) = -1.786728  0.305780
VSHIFT(1 TO 2) = -0.08170  0.20000  
$VSHIFT(1 TO 2) = -1.786728  0.20000  $ matches oil(water) phase props.

$ ISOBARIC SPECIFIC HEATS
$HCCP(1 TO 2) = 8.7646  18.01459
HCCP(1 TO 2) = 8.7646  17.8176

$ BINARY INTERACTION COEFFICIENTS
BINACT(1,2) = .005
BINACT(2,1) = .005

MODREL(1)  2

$ SURFACE CONDITIONS 
TSURF = 60.0  PSURF = 14.7

$ Set the top corner of the reservoir
XYZ111(,1) = 640.0[m] 0.0[m] 0.0[m]

$ INITIAL CONDITIONS

PORPRES1() = 14.7
SWINIT1() = 0.0

$ NX=27
PRES1(1,,) = 996.2745
PRES1(2,,) = 1000.7349
PRES1(3,,) = 1006.6821
PRES1(4,,) = 1017.0897
PRES1(5,,) = 1027.4973
PRES1(6,,) = 1033.4445
PRES1(7,,) = 1037.4589
PRES1(8,,) = 1038.7226
PRES1(9,,) = 1039.0943
PRES1(10,,) = 1039.3174
PRES1(11,,) = 1064.1469
PRES1(12,,) = 1113.6574
PRES1(13,,) = 1163.1678
PRES1(14,,) = 1187.9974
PRES1(15,,) = 1188.1460
PRES1(16,,) = 1188.3691
PRES1(17,,) = 1188.6664
PRES1(18,,) = 1189.1868
PRES1(19,,) = 1189.9302
PRES1(20,,) = 1190.6736
PRES1(21,,) = 1192.1604
PRES1(22,,) = 1194.3906
PRES1(23,,) = 1196.6208
PRES1(24,,) = 1201.0812
PRES1(25,,) = 1207.7718
PRES1(26,,) = 1214.4624
PRES1(27,,) = 1225.2417   $Problem 1.1 - 1232.6757 psi at 800m

CONC1(,,,1) = 0.0
CONC1(,,,2) = 1.0

$ INITIAL TEMPERATURES
TEMPR1(1,,) = 84.6140
TEMPR1(2,,) = 84.7760
TEMPR1(3,,) = 84.9920
TEMPR1(4,,) = 85.3700
TEMPR1(5,,) = 85.7480
TEMPR1(6,,) = 85.9640
TEMPR1(7,,) = 86.1098
TEMPR1(8,,) = 86.1557
TEMPR1(9,,) = 86.1692
TEMPR1(10,,) = 86.1773
TEMPR1(11,,) = 87.0791
TEMPR1(12,,) = 88.8773
TEMPR1(13,,) = 90.6755
TEMPR1(14,,) = 91.5773
TEMPR1(15,,) = 91.5827
TEMPR1(16,,) = 91.5908
TEMPR1(17,,) = 91.6016
TEMPR1(18,,) = 91.6205
TEMPR1(19,,) = 91.6475
TEMPR1(20,,) = 91.6745
TEMPR1(21,,) = 91.7285
TEMPR1(22,,) = 91.8095
TEMPR1(23,,) = 91.8905
TEMPR1(24,,) = 92.0525
TEMPR1(25,,) = 92.2955
TEMPR1(26,,) = 92.5385
TEMPR1(27,,) = 92.9300

$ SEPARATORS
PSEP(,1) = 14.7 
TSEP(,1) = 60. 

$ SEPARATOR ASSIGNMENT FOR IN-PLACE CALCULATIONS
SEPSURF = 1

$ POROSITY
CR1() = 0.0
POROSITY1() = .15

$ PERMEABILITIES

$ NX=27
XPERM1(1 TO 9,,) = 20.265  XPERM1(15 TO 27,,) =  20.265
YPERM1(1 TO 9,,) = 20.265  YPERM1(15 TO 27,,) =  20.265
ZPERM1(1 TO 9,,) = 20.265  ZPERM1(15 TO 27,,) =  20.265
XPERM1(10 TO 14,,) = 0.0  YPERM1(10 TO 14,,) = 0.0  ZPERM1(10 TO 14,,) = 0.0 
$ NYxNZ 30x1
XPERM1(,20,) = 1013.25  
YPERM1(,20,) = 1013.25  
ZPERM1(,20,) = 1013.25
 
Include P1_2relprm.dat

PCOW(1) Block        $ WATER-OIL CAPILLARY PRESSURE - ROCK TYPE 1
  Interpolation Linear
  Extrapolation  Constant
$ Pcow vs Sw (zero - Problem 1.1)
Data  .000000    .0000000
     1.000000    .0000000
EndBlock

PCGO(1) Block        $ GAS-OIL CAPILLARY PRESSURE - ROCK TYPE 1
  Interpolation Linear
  Extrapolation  Constant
$ Pcgo vs Sw (Brooks-Corey - Problem 1.2)
Data  .210000  12.5606333
     0.250000   5.6172860
     0.300000   3.9720210
     0.350000   3.2431416
     0.400000   2.8086430
     0.450000   2.5121266
     0.500000   2.2932474
     0.550000   2.1231345
     0.600000   1.9860105
     0.650000   1.8724286
     0.700000   1.7763418
     0.750000   1.6936754
     0.800000   1.6215708
     0.850000   1.5579548
     0.900000   1.5012828
     0.950000   1.4503770
     1.000000   1.4043215
EndBlock
$ Pcgo vs Sw (zero - Problem 1.1)
$Data  .000000    .0000000
$     1.000000    .0000000
$EndBlock

$ WELLS

$NUMWELL=49
NUMWELL=3

WELLNAME(1) = "WELL 1 INJECTION"
KINDWELL(1) = 4
$PLIMITC(1) = 3500.
DIAMETER(1,1) = 0.2999[m]
WELLTOP(1 TO 3,1,1) =     770.0[m]  400.0[m]  1.0[m]
WELLBOTTOM(1 TO 3,1,1) =  800.0[m]  400.0[m]  1.0[m]
WELLPQ(1) Block
  Interpolation Step
  Extrapolation Constant
  Data    0.  14553.508
EndBlock

WELLNAME(2) = "WELL 2 DIRICHLET BC"
KINDWELL(2) = 31
WDEPTH(2) = 800.0[m]
WELLTOP(1 TO 3,1,2) =     640.0[m]  1.0[m]  1.0[m]
WELLBOTTOM(1 TO 3,1,2) =  800.0[m]  1.0[m]  1.0[m]
WELLPQ(2) Block
  Interpolation Step
  Extrapolation Constant
  Data    0.  1232.6757
EndBlock

WELLNAME(3) = "WELL 3 DIRICHLET BC"
KINDWELL(3) = 31
WDEPTH(3) = 800.0[m]
WELLTOP(1 TO 3,1,3) =     640.0[m]  999.0[m]  1.0[m]
WELLBOTTOM(1 TO 3,1,3) =  800.0[m]  999.0[m]  1.0[m]
WELLPQ(3) Block
  Interpolation Step
  Extrapolation Constant
  Data    0.  1232.6757
EndBlock

$Include wells2to49.dat

$ WELL OUTPUT FLAGS
 WOUTFLG(2 TO 3) = FALSE
 $WOUTFLG(2 TO 49) = FALSE

$ NON-AQUEOUS COMPONENT WELL OUTPUT FLAGS
 $WELXOUT(1,)
 $WELXOUT(2,)
 $WXELOUT(1,2) = 7

$ INJECTION COMPOSITION
 COMPINJ(,1) = 0.0 1.0 0.0 
 $COMPINJ(,2) = 1.0 0.0 0.0
 INJCOMP(1) = 1
 $INJCOMP(3 TO 47) = 2
 TINJ(1) = 92.48 

$ SEPARATOR ASSIGNMENT FOR WELLS
$IWSEP(2) = 1

$ PRINTOUTS
 $OUT_MOLDW = TRUE 
 $OUT_MOLD = TRUE 
 $OUT_VISCW = TRUE
 $OUT_VISC = TRUE
 XDARCYFLUX = TRUE

EndInitial

$ TRANSIENT DATA INPUT BLOCKS

BeginTime    0.0
   $DELTIM = 0.1  
   $DTIMMUL = 2.0 
   $DELTIM = 0.005  
   $DELTIM = 0.0025  
   $DELTIM = 0.001 
   $DELTIM = 0.0005
   $DELTIM = 0.00025 
   DELTIM = 0.0001
   DTIMMUL = 1.002
   DTIMMIN = 1.0E-06
   DTIMMAX = 1.0
   TIMOUT = 0.01
   $DTIMOUT = 365.0
   $DTIMOUT = 0.01
   $DTIMOUT = 0.25
   $DTIMOUT = 0.5
   DTIMOUT = 5.0
   DSMAX .1

   $ VISUALIZATION
   $VISOUT = 0.1  DVISOUT = 121.3
   $VISOUT = 0.01  DVISOUT = 10.0
   $VISOUT = 0.01  DVISOUT = 5.0
   $VISOUT = 0.01  DVISOUT = 1.0
   VISOUT = 0.01  DVISOUT = 0.5
   $VISOUT = 0.01  DVISOUT = 0.25
   $VISOUT = 0.01  DVISOUT = 0.1
   $VISOUT = 0.01  DVISOUT = 0.025
   $VISOUT = 0.01  DVISOUT = 0.01
   $VISOUT = 0.1  DVISOUT = 100.0
   $VISOUT = 0.1  DVISOUT = 3650.0
   VIS_SCL = 5
   VISFLAG = 3
   VIS_SCL_NAMES(1) = "PRES"
   VIS_SCL_NAMES(2) = "SOIL"
   VIS_SCL_NAMES(3) = "SGAS"
   VIS_SCL_NAMES(4) = "CO2"
   VIS_SCL_NAMES(5) = "TEMP"
   VIS_NVEC = 1
   VIS_VEC_NAMES(1) = "XVEL_GAS" 
   VIS_FNAME = "CO2p1_2a_"
EndTime

BeginTime 100.0
$DELTIM = 0.00025
$DTIMMAX = 5.0
EndTime

$BeginTime 200.0
$DELTIM = 0.00025
$DTIMMAX = 5.0
$EndTime

$BeginTime 500.0
$DELTIM = 0.00025
$DTIMMAX = 25.0
$EndTime

$BeginTime 18250.0
$KINDWELL(1) = 0
$KINDWELL(2) = 0
$KINDWELL(3) = 0
$KINDWELL(4) = 0
$EndTime

BeginTime 23725.0
$DTIMMAX = 100.0
DTIMMAX = 2.5
DTIMOUT = 1095.0
EndTime

BeginTime 146100.0
$DTIMMAX = 100.0
DTIMMAX = 5.0
$DTIMMAX = 1000.0
DTIMOUT = 3650.0
EndTime

