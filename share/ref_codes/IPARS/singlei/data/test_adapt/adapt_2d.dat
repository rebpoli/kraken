TITLE(1)="Single phase with semi-structured evfem"

DESCRIPTION()=
"Grid adaptivity test"
"Ben Ganis"
"5/1/17"

BLOCKMODEL(1)="SINGLE_PHASE_IMPLICIT"
BLOCKMODEL(2)="SINGLE_PHASE_IMPLICIT"
BLOCKMODEL(3)="SINGLE_PHASE_IMPLICIT"
BLOCKMODEL(4)="SINGLE_PHASE_IMPLICIT"

$TIMEEND = 0.001
$TIMEEND = 0.01
$TIMEEND = 0.2
$TIMEEND = 1.
$TIMEEND = 5.
TIMEEND = 20.0
$TIMEEND = 500.0

$ I/O OPTIONS
$ DEBUGS  
$ DEBUGM
$ OUTLEVEL = 2
$ BUGKEY(6)
$ BUGKEY(10)
$PROCOUT
$EXTRA_TIMING
$WELLOUTKEY = 3  WELLFILE = "WELLS.WEL"  WELLFCUM = "CUMULATIVE.WEL"

$ Use fully coupled enhanced velocity solver
LSOL_TOL=1.E-9
LSOL_ITMAX=100
HYPRE_EVFEM

$ Inherit processor grid assignment from fault block 1
EV_PRCBLK=1

$ Adaptivity options
ADAPTIVITY
ADAPT_MODE = 3
ADAPT_VARS = 1
ADAPT_VAR(1) = "PRES"  ADAPT_TOL(1) = 5.
NDIMA = 2
NSTRIDE = 2

$ To run fine scale without adaptivity
$KEYOUT1()=0
$KEYOUT2()=0
$KEYOUT3()=0

$----- INCLUDE CORNER POINT MESH DATA
BLOCKNAME(1) = "BLOCK 1"
DOWN(1 TO 3,1) = 1. 0. 0.
XYZ111(,1)= 8000. 0. 0.
NX(1)=1  NY(1)=20  NZ(1)=20
DX(,1)=5. DY(,1)=80. DZ(,1)=80.

BLOCKNAME(2) = "BLOCK 2"
DOWN(1 TO 3,2) = 1. 0. 0.
XYZ111(,2)= 8000. 0. 0.
NX(2)=1  NY(2)=40  NZ(2)=40
DX(,2)=5. DY(,2)=40. DZ(,2)=40.

BLOCKNAME(3) = "BLOCK 3"
DOWN(1 TO 3,3) = 1. 0. 0.
XYZ111(,3)= 8000. 0. 0.
NX(3)=1  NY(3)=80  NZ(3)=80
DX(,3)=5. DY(,3)=20. DZ(,3)=20.

BLOCKNAME(4) = "BLOCK 4"
DOWN(1 TO 3,4) = 1. 0. 0.
XYZ111(,4)= 8000. 0. 0.
NX(4)=1  NY(4)=160  NZ(4)=160
DX(,4)=5. DY(,4)=10. DZ(,4)=10.

FACEBLOCKS(,1) = 1 2  FACEXYZ(,1) = 0. 0. 0., 0. 0. 0.
FACEBLOCKS(,2) = 1 3  FACEXYZ(,2) = 0. 0. 0., 0. 0. 0.
FACEBLOCKS(,3) = 1 4  FACEXYZ(,3) = 0. 0. 0., 0. 0. 0.
FACEBLOCKS(,4) = 2 3  FACEXYZ(,4) = 0. 0. 0., 0. 0. 0.
FACEBLOCKS(,5) = 2 4  FACEXYZ(,5) = 0. 0. 0., 0. 0. 0.
FACEBLOCKS(,6) = 3 4  FACEXYZ(,6) = 0. 0. 0., 0. 0. 0.

$ Fluid properties
FLVIS = 2.
STFLDEN = 56.
FLCOMP = 1.E-5

$ INITIAL CONDITIONS

DINIT = 8000.
PINIT = 2000.

$ POROSITY AND PERM
POROSITY1() = .30
XPERM1()=50.

POROSITY2() = .30
XPERM2()=50.

POROSITY3() = .30
XPERM3()=50.

POROSITY4() = .30
XPERM4()=50.

NUMWELL=5

WELLNAME(1) = "WELL 1"
KINDWELL(1) = 31
WELLBLOCK(1,1) = 4
WELLTOP(1 TO 3,1,1) =     8000.      797.5      797.5
WELLBOTTOM(1 TO 3,1,1) =     8125.      797.5      797.5
WELLPQ(1) Block
  Interpolation Linear
  Extrapolation Constant
  Data        0.     2000.
EndBlock

WELLNAME(2) = "WELL 2"
KINDWELL(2) = 1
WELLBLOCK(1,2) = 4
WELLTOP(1 TO 3,1,2) =     8000.      397.5      397.5
WELLBOTTOM(1 TO 3,1,2) =     8125.      397.5      397.5
WELLPQ(2) Block
  Interpolation Linear
  Extrapolation Constant
  Data        0.     4000.
EndBlock

WELLNAME(3) = "WELL 3"
KINDWELL(3) = 1
WELLBLOCK(1,3) = 4
WELLTOP(1 TO 3,1,3) =     8000.      397.5     1202.5
WELLBOTTOM(1 TO 3,1,3) =     8125.      397.5     1202.5
WELLPQ(3) Block
  Interpolation Linear
  Extrapolation Constant
  Data        0.     4000.
EndBlock

WELLNAME(4) = "WELL 4"
KINDWELL(4) = 1
WELLBLOCK(1,4) = 4
WELLTOP(1 TO 3,1,4) =     8000.     1202.5     1202.5
WELLBOTTOM(1 TO 3,1,4) =     8125.     1202.5     1202.5
WELLPQ(4) Block
  Interpolation Linear
  Extrapolation Constant
  Data        0.     4000.
EndBlock

WELLNAME(5) = "WELL 5"
KINDWELL(5) = 1
WELLBLOCK(1,5) = 4
WELLTOP(1 TO 3,1,5) =     8000.     1202.5      397.5
WELLBOTTOM(1 TO 3,1,5) =     8125.     1202.5      397.5
WELLPQ(5) Block
  Interpolation Linear
  Extrapolation Constant
  Data        0.     4000.
EndBlock

VISINIT
VIS_FNAME = "Vis_adapt"
VISFLAG = 9
VIS_SCL = 2
VIS_SCL_NAMES(1) = "PRES"
VIS_SCL_NAMES(2) = "MARK"
$VIS_BINARY = FALSE

EndInitial

$ TRANSIENT DATA INPUT BLOCKS

BeginTime    0.0
$   DELTIM = 0.0001  DTIMMUL = 1.0
   DELTIM = 0.1  DTIMMUL = 1.0
   DTIMMIN = 0.00001
   DTIMMAX = 1.0
   DTIMOUT = 1.

$   VISALL
$   VISNEWT
   VISOUT = 0.1  DVISOUT = 0.1
$   VISOUT = 10.  DVISOUT = 10.
EndTime

