TITLE(2)="TRANSPORT WITH SINGLE_PHASE_IMPLICIT FLOW"
$ Tested in parallel on using tighter MISCLINTOL

DESCRIPTION()=
"LENGTH (FT) : 1000"
"WIDTH (FT) : 1000"
"THICKNESS (FT) : 20"
"GRID BLOCKS : 2x10X20X20   8000 GRID ELEMENTS"
"DATE : 6/9/98"

BLOCKMODEL(1 TO 2)="TRANSPORT_CHEMISTRY"

TIMEEND = 150.1
$TIMEEND = 20.1

$ I/O OPTIONS
OUTLEVEL = 2
WELLOUTKEY = 3   WELLFILE = "TRT1.WEL"

$$$ FLOW MODEL SPECIFICATION AND DATA
$ currently assumes all domains have similar flow model 

FLOW_MODEL = "SINGLE_PHASE_IMPLICIT"

$ NEWTON ITERATION OPTIONS (FOR FLOW)
$MAXNEWT = 20
CVTOL = 1.0E-6
$CVTOL = 1.0E-8

$$$ LINEAR SOLVER OPTIONS
$ MULTI-GRID
$LINTOL = 1.0E-06
$SOROPT = TRUE

$ LINE SOR

$SORTOL = 1.E-7
$SOROPT = TRUE
$MAXJK = 40

$ GMRES

LSOL_TOL = 1.0E-06
TMP_LSOL_TOL = 1.E-10
LSOL_ITMAX = 5000
GMRES_PREC = 15
N_GS_STEP = 5

$ GMRES-SAMG

$SAMG
$LSOL_TOL = 1.0E-06
$GMRES_PREC = 18
$N_GS_STEP = 5

$ BCGS
$LINTOL = 1.0E-05
$LINTOL = 1.0E-08
$MISCLINTOL = 1.0E-10
$MISCLINTOL = 1.0E-12

$$$ FAULT BLOCK AND MESH DATA

FACEBLOCKS(,1) = 1 2  
FACEXYZ(,1) = 0. 0. 0., 0. 0. 0.

BLOCKNAME(1) = "BLOCK1"
DOWN(,1) = 1 0 0
NX(1) = 10  NY(1) = 20  NZ(1) = 20
DX(,1) = 2.   DY(,1) = 10.  DZ(,1) = 20.
XYZ111(,1) = 0. 0. 0.

BLOCKNAME(2) = "BLOCK2"
DOWN(,2) = 1 0 0
NX(2) = 10  NY(2) = 20  NZ(2) = 20
DX(,2) = 2.   DY(,2) = 10.  DZ(,2) = 20.
XYZ111(,2) = 0. 200. 0.

$$$ INITIAL CONDITIONS

PINIT = 500.

$ FLOW MODEL SPECIFIC PARAMETERS

FLCOMP = 4.2E-5

$ POROSITY

POROSITY1() = .2   POROSITY2() = .2

$ PERMEABILITIES

$ Block 1

$XPERM1() = 20.0  $XPERM1(8,,) = 5.0
$$XPERM1(5 TO 6,,) = 5.0
$YPERM1() = 200.0

$ Block 2

$XPERM2() = 20.0  $XPERM2(8,,) = 5.0
$$XPERM2(3,,) = 5.0
$XPERM2(5 TO 6,,) = 5.0
$YPERM2() = 200.0

$ Barrier case

$ Block 1

XPERM1() = 200.
XPERM1(3,,) = 2000.
XPERM1(6,,) = 1000.
XPERM1(,16,1 TO 12) = 2.

YPERM1() = 1000.
YPERM1(3,,) = 10000.
YPERM1(6,,) = 5000.
YPERM1(,16,1 TO 12) = 10.

ZPERM1() = 1000.
ZPERM1(3,,) = 10000.
ZPERM1(6,,) = 5000.
ZPERM1(,16,1 TO 12) = 10.

$ Block 2
 
XPERM2() = 200.
XPERM2(3,,) = 2000.
XPERM2(6,,) = 1000.
XPERM2(,4,8 TO 20) = 2.

YPERM2() = 1000.
YPERM2(3,,) = 10000.
YPERM2(6,,) = 5000.
YPERM2(,4,8 TO 20) = 10.

ZPERM2() = 1000.
ZPERM2(3,,) = 10000.
ZPERM2(6,,) = 5000.
ZPERM2(,4,8 TO 20) = 10.

$ VISUALIZE PERMEABILITY AT INITIAL TIME

$ PERMOUT
$ VIS_SCL = 3                  $ Set the number of vis. scalar variables
$ VISFLAG = 2                  $ Piece-wise constant visualization output
$ VIS_FNAME = "PERM2B_CASE1"     $ set the name of vis. output files
$ VIS_SCL_NAMES(1) = "TCOFX"   $ Specify the name of vis. scalar variables
$ VIS_SCL_NAMES(2) = "TCOFY"
$ VIS_SCL_NAMES(3) = "TCOFZ"

$$$ TRANSPORT-CHEMISTRY PART

NSPECIES = 1
N_CONC_STEPS = 2
CONC1_1(,,) = 0. 
CONC1_2(,,) = 0. 
CONC1_1(1,1,1) = 1.

EQ_PARTITIONING_COEFF () = 0.0
EQ_PARTITIONING_COEFF (1,1)= 1.0

$ DIFFUSION-DISPERSION PART

TRDDLINSOL = 1
$TRDDLINSOL = 2
MOLECULAR_DIFFUSIVITY(,,) = 1.
$LONGITUDINAL_DISPERSIVITY(,1) = 1.0     
$TRANSVERSE_DISPERSIVITY(,1) = 0.2 

$ ADVECTION (H.O.G.) PART

$TRNOFLXLMTR
TRFLXLMTRTYPE = 3
TRFLXLMTR = 1.0 

$$$ WELLS

NUMWELL=2

WELLNAME(1) = "FIRST WELL"
KINDWELL(1) = 1
WELLBLOCK(1,1) = 1
WELLTOP(1 TO 3,1,1) = 0. 2*5.
WELLBOTTOM(1 TO 3,1,1) = 20. 2*5.
WELLPQ(1) Block
  Interpolation Linear
  Extrapolation Constant
  Data  0.  510.
EndBlock

WELLNAME(2) = "SECOND WELL"
KINDWELL(2) = 31
WELLBLOCK(1,2) = 2
WELLTOP(1 TO 3,1,2) = 0. 2*395.
WELLBOTTOM(1 TO 3,1,2) = 20. 2*395.
WELLPQ(2) Block
  Interpolation Linear
  Extrapolation Constant
  Data  0.  480.  30.  350.
EndBlock

EndInitial

$ TRANSIENT DATA INPUT BLOCKS

BeginTime    0.
DELTIM = 0.01
DTIMMUL = 1.0001
DTIMMAX = 0.01
TIMOUT = 10.  
DTIMOUT = 10.
TIMRES = 9999.
DTIMRES = 9999.
$ visualization paramaters
VISOUT = 5.0
DVISOUT = 5.0
VIS_SCL = 2
VIS_SCL_NAMES(1) = "PRES"
VIS_SCL_NAMES(2) = "CONC1_"
VIS_NVEC = 1
VIS_VEC_NAMES(1) = "TRV"
VIS_FNAME = "TRT_MB2B_"
VISFLAG = 3
EndTime

BeginTime    40.
TIMOUT = 50.  
DTIMOUT = 20.  
DTIMMAX = 3.
FORMAT = TRUE  
DVISOUT = 10.
EndTime

BeginTime    100.
DTIMMAX = 6.  
TIMOUT = 120.   
DTIMOUT = 40.
DVISOUT = 20.
EndTime

